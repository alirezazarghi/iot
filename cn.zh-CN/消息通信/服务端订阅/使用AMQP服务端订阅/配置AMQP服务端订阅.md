---
keyword: [IoT, 物联网平台, AMQP, 服务端订阅设备消息]
---

# 配置AMQP服务端订阅

本文介绍在物联网平台控制台设置和管理AMQP服务端订阅。

## 设置订阅

在物联网平台控制台设置服务端订阅的消息类型。

1.  登录[物联网平台控制台](http://iot.console.aliyun.com/)。

2.  在左侧导航栏，选择**规则引擎** \> **服务端订阅**。

3.  在服务端订阅页，单击**创建订阅**。

4.  在创建订阅对话框中，完成配置，单击**确认**。

    |参数|说明|
    |--|--|
    |产品|选择订阅消息源设备所属的产品。|
    |订阅类型|选择为**AMQP**。|
    |消费组|选择消息的消费组。 支持选择多个消费组。 物联网平台已为您生成了一个默认消费组。如果您需要对消费端进行分组，请单击选择目标消费组对话框右下角的**创建消费组**，新建消费组。消费组相关说明，请参见[管理消费组](/cn.zh-CN/消息通信/服务端订阅/使用AMQP服务端订阅/管理消费组.md)。 |
    |推送消息类型|服务端要订阅的消息类型。目前，服务端可订阅的设备消息类型包括：     -   **设备上报消息**：产品下所有设备Topic列表中，**操作权限**为**发布**的Topic中的消息。勾选后，可以通过AMQP SDK接收设备发布的消息。

设备上报消息，包括设备上报的自定义数据和物模型数据（属性上报、事件上报、属性设置响应和服务调用响应）。推送到服务端的物模型数据是经物联网平台系统处理过后的数据，数据格式请参见[数据格式](/cn.zh-CN/消息通信/数据格式.md)。

例如，一个产品有3个Topic类，分别是：

        -   `/${YourProductKey}/${YourDeviceName}/user/get`，具有订阅权限。
        -   `/${YourProductKey}/${YourDeviceName}/user/update`，具有发布权限。
        -   `/${YourProductKey}/${YourDeviceName}/thing/event/property/post`，具有发布权限。
那么，服务端订阅会推送具有发布权限的Topic类中的消息，即`/${YourProductKey}/${YourDeviceName}/user/update`和`/${YourProductKey}/${YourDeviceName}/thing/event/property/post`中的消息。

    -   **设备状态变化通知**：该产品下的设备上下线状态变化时通知的消息。
    -   **网关子设备发现上报**：网关将发现的子设备信息上报给物联网平台。需要网关上的应用程序支持。网关产品特有消息类型。
    -   **设备拓扑关系变更**：子设备和网关之间的拓扑关系建立和解除消息。网关产品特有消息类型。
    -   **设备生命周期变更**：设备创建、删除、禁用、启用等消息。
    -   **物模型历史数据上报**：设备上报的属性和事件历史数据。
    -   **OTA升级状态通知**：验证升级包和批量升级时，设备升级成功或失败的事件通知。
    -   **设备标签变更**：设备上报的标签变更消息。
    -   **OTA模块版本号上报**：设备上报的OTA模块版本号变更消息。
    -   **OTA升级批次状态通知**：设备OTA升级批次状态变化通知。 |


[配置AMQP客户端](/cn.zh-CN/消息通信/服务端订阅/使用AMQP服务端订阅/AMQP客户端接入说明.md)

所有配置完成，且设备上报订阅数据，并被AMQP客户端接收后，您可以在物联网平台控制台**监控运维** \> **日志服务**中云端运行日志页签下，查看设备上报数据、物联网平台转发数据到AMQP客户端和AMQP客户端返回ACK的日志记录。

