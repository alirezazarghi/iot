设备调试 
=========================

设备端开发完成后，您可以使用物联网平台的在线调试功能，从控制台下发指令给设备端进行功能测试。

在线调试功能提供如下两种调试方式，请根据您的实际情况选择调试方式。本文使用真实设备调试：

* [调试真实设备](/cn.zh-CN/监控运维/在线调试/调试真实设备.md)

  

* [调试虚拟设备](/cn.zh-CN/监控运维/在线调试/调试虚拟设备.md)

  




![在线调试功能说明](//static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6931649951/p140298.png)

在线调试 
-------------------------

1. 登录[物联网平台控制台](https://iot.console.aliyun.com/)，在对应实例下的左侧导航栏，选择 **监控运维** \> **在线调试** 。

   

2. 在 **在线调试** 页，选择本次调试的充电桩设备（device-1）。

   

3. 选择 **调试真实设备** 。

   

4. 根据如下图所示，进行服务调用。

   ![充电桩调试-服务调用](//static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6931649951/p140484.png)

   云端下发数据后，可在设备端查看相关日志是否打印，以此判断指令是否达到设备端。

   ![设备端日志](//static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7931649951/p140502.png)
   

5. 根据如下图所示，进行属性调试。

   ![充电桩属性调试](//static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7931649951/p141064.png)

   调试方法说明如下所示。
   

   |  参数   |                                                   描述                                                   |
   |-------|--------------------------------------------------------------------------------------------------------|
   | 获取    | 从设备上获取指定属性的值。                                                                                          |
   | 设置    | 从云端下发设置（set）属性值的指令给设备。设备收到指令后，设置属性值，并将最新属性值上报给云端。                                                      |
   | 设置期望值 | 从云端下发设置期望属性值的指令给设备。如果下发指令时设备在线，设备立即收到指令，更新该属性值，并将新属性值上报云端；如果下发指令时设备不在线，待设备重新上线时主动获取期望属性值信息，然后更新属性值并上报。 |

   

   云端下发数据后，可在设备端查看相关日志是否打印，以此判断指令是否达到设备端。从图中可见设备收到set指令后，返回了服务的响应信息，同时向云端上报了最新属性。

   ![设置属性后的设备log](//static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7931649951/p141067.png)
   

6. 在左侧导航栏，单击 **设备** ，再单击目标设备（device-1）后的 **查看** 。

   

7. 在 **设备详情** 页 **物模型数据** \> **事件管理** 页签下，查看设备上报的属性、事件和服务调用数据，判断设备是否收到云端指令，并且正常返回响应信息。

   * 设备上报的当前属性值如下。

     ![充电桩物模型数据-运行状态](//static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7931649951/p141070.png)
     
   
   * 设备事件如下。

     ![充电桩物模型数据-事件](//static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7931649951/p141203.png)
     
   
   * 设备服务调用如下。

     ![充电桩物模型数据-服务调用](//static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7931649951/p141071.png)
     
   

   




日志服务 
-------------------------

设备在运行过程，可能会出现一些异常，例如连接失败、认证失败、设备上报的数据不符合物模型规范等，您可以通过[日志服务](/cn.zh-CN/监控运维/日志服务/云端运行日志.md)查看和排查问题。

例如，本案例的[云端配置](/cn.zh-CN/最佳实践/物模型接入价值与实践/云端配置.md)中已定义事件参数`gunNum`的取值范围为0\~100，当真实设备上报的值超过该范围时，日志服务会展示该错误详情。

![gunNum参数值超过取值范围](//static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/8931649951/p141750.png)

在物联网平台对应实例下，左侧导航栏单击 **监控运维** \> **日志服务** ，查看日志信息。

![查看充电桩日志服务](//static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/8931649951/p141753.png)

同时您也可以开启 **日志转储** ，通过 **日志报表** 功能进一步查看设备大盘，包括设备上下线次数、设备上线IP区域分布、设备消息量、设备消息量Top列表、物模型错误分布、云端API错误分布等多维度指标。日志转储相关说明请参见[日志转储](/cn.zh-CN/监控运维/日志服务/日志转储.md)。

![充电桩日志报表](//static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/8931649951/p141762.png)

后续步骤 
-------------------------

[服务端开发](/cn.zh-CN/最佳实践/物模型接入价值与实践/服务端开发/服务端调用API开发.md)
